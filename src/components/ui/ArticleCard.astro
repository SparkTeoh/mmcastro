---
// ArticleCard component for MMC Astro
// Based on SparkAstro's ArticleCard component but adapted for MMC's style

import Card from "./Card.astro";

interface Props {
  article: {
    title: string;
    summary: string;
    author: string;
    pubDate: Date;
    tags: string[];
    type: string;
    slug: string;
    authImage?: string;
  };
}

const { article } = Astro.props;

// Format date function
function formatDate(date: Date): string {
  return new Intl.DateTimeFormat('zh-CN', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date);
}

// Get type icon based on article type
function getTypeIcon(type: string): string {
  switch (type) {
    case 'Article':
      return 'ğŸ“„';
    case 'Video':
      return 'ğŸ¥';
    case 'ä¸“ä¸šå†…å®¹':
      return 'ğŸ’¼';
    case 'æ¡ˆä¾‹åˆ†æ':
      return 'ğŸ“Š';
    default:
      return 'ğŸ“„';
  }
}
---

<Card isUnderline={true} className="hover:shadow-lg transition-shadow duration-300">
  <article class="p-6">
    <div class="flex justify-between items-center mb-4 text-gray-500">
      <span class="bg-primary text-white text-xs font-medium inline-flex items-center px-3 py-1 rounded-full">
        <span class="mr-1">{getTypeIcon(article.type)}</span>
        {article.type}
      </span>
      <span class="text-sm">{formatDate(article.pubDate)}</span>
    </div>
    
    <h2 class="mb-3 text-xl font-bold tracking-tight text-primary hover:text-accent transition-colors">
      {article.title}
    </h2>
    
    <p class="mb-4 font-light text-text-default leading-relaxed" style="white-space: pre-line">
      {article.summary}
    </p>
    
    <!-- Tags -->
    {article.tags && article.tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-4">
        {article.tags.slice(0, 3).map((tag) => (
          <span class="inline-block bg-gray-100 text-primary px-2 py-1 rounded text-xs font-medium">
            {tag}
          </span>
        ))}
        {article.tags.length > 3 && (
          <span class="inline-block bg-gray-100 text-primary px-2 py-1 rounded text-xs font-medium">
            +{article.tags.length - 3}
          </span>
        )}
      </div>
    )}
    
    <div class="flex justify-between items-center">
      <div class="flex items-center space-x-3">
        {article.authImage ? (
          <img 
            class="w-8 h-8 rounded-full object-cover" 
            src={article.authImage} 
            alt={article.author + " å¤´åƒ"} 
          />
        ) : (
          <div class="w-8 h-8 rounded-full bg-primary flex items-center justify-center">
            <span class="text-white text-sm font-bold">
              {article.author.charAt(0)}
            </span>
          </div>
        )}
        <span class="font-medium text-primary">
          {article.author}
        </span>
      </div>
      
      <a 
        href={`/content/${article.slug}`} 
        class="inline-flex items-center font-medium text-primary hover:text-accent transition-colors"
      >
        é˜…è¯»æ›´å¤š
        <svg class="ml-2 w-4 h-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
        </svg>
      </a>
    </div>
  </article>
</Card>
